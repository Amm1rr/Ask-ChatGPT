Build1=Default,com.ask.chatgpt
File1=Acme-Regular.ttf
File10=menu.png
File11=message.png
File12=montserrat-medium.ttf
File13=PROMPTS.md
File14=puton.png
File15=roboto-regular.ttf
File16=settings.png
File17=voice.png
File2=brain.png
File3=Changelog.txt
File4=Chat.bal
File5=clvAnswerRow.bal
File6=clvQuestionRow.bal
File7=clvWaitingText.bal
File8=gray-tipped.png
File9=LeftDrawer.bal
FileGroup1=Default Group
FileGroup10=Default Group
FileGroup11=Default Group
FileGroup12=Default Group
FileGroup13=Default Group
FileGroup14=Default Group
FileGroup15=Default Group
FileGroup16=Default Group
FileGroup17=Default Group
FileGroup2=Default Group
FileGroup3=Default Group
FileGroup4=Default Group
FileGroup5=Default Group
FileGroup6=Default Group
FileGroup7=Default Group
FileGroup8=Default Group
FileGroup9=Default Group
Group=Default Group
Library1=as_textfieldadvanced
Library10=md2html4a.11
Library11=okhttputils2
Library12=phone
Library13=reflection
Library14=securemytext
Library15=viewsex
Library16=webviewextras2
Library17=xcustomlistview
Library18=xui views
Library19=randomaccessfile
Library2=b4xdraweradvanced
Library3=bctextengine
Library4=clipboard
Library5=core
Library6=designerutils
Library7=ime2
Library8=json
Library9=keyvaluestore2
ManifestCode='This code will be applied to the manifest file during compilation.~\n~'You do not need to modify it in most cases.~\n~'See this link for for more information: https://www.b4x.com/forum/showthread.php?p=78136~\n~AddManifestText(~\n~<uses-sdk android:minSdkVersion="5" android:targetSdkVersion="31"/>~\n~<supports-screens android:largeScreens="true" ~\n~    android:normalScreens="true" ~\n~    android:smallScreens="true" ~\n~    android:anyDensity="true"/>)~\n~SetApplicationAttribute(android:icon, "@drawable/icon")~\n~SetApplicationAttribute(android:label, "$LABEL$")~\n~CreateResourceFromFile(Macro, Themes.LightTheme)~\n~'End of default text.~\n~~\n~AddActivityText(Main,~\n~<intent-filter>~\n~   <action android:name="android.intent.action.SEND" />~\n~   <category android:name="android.intent.category.DEFAULT" />~\n~   <data android:mimeType="image/*" />~\n~   <data android:mimeType="text/*" />~\n~</intent-filter>)~\n~~\n~'For Creating custom Text Selection actions with ACTION_PROCESS_TEXT~\n~SetActivityAttribute(ACTION_PROCESS_TEXT, android:label, "Ask ChatGPT")~\n~AddActivityText(ACTION_PROCESS_TEXT,~\n~<intent-filter>~\n~	<action android:name="android.intent.action.PROCESS_TEXT" />~\n~	<category android:name="android.intent.category.DEFAULT" />~\n~	<data android:mimeType="text/plain" />~\n~</intent-filter>)~\n~~\n~
Module1=ACTION_PROCESS_TEXT
Module10=UpDown
Module2=Bart
Module3=ChatGPT
Module4=ChatN
Module5=ChatNew
Module6=CLVNested
Module7=General
Module8=ResizingTextComponent
Module9=Starter
NumberOfFiles=17
NumberOfLibraries=19
NumberOfModules=10
Version=12.2
@EndOfDesignText@
#Region Project Attributes
	#ApplicationLabel: Ask ChatGPT
	#VersionCode: 12
	#VersionName: Develop
	'SupportedOrientations possible values: unspecified, landscape or portrait.
	#SupportedOrientations: portrait
	#CanInstallToExternalStorage: False
#End Region

#Region Activity Attributes
	#FullScreen: False
	#IncludeTitle: False
#End Region

#BridgeLogger: True

Sub Process_Globals
	Private OldIntent 				As Intent
	Public	Voicer 					As VoiceRecognition
	Public 	ActionBarHomeClicked 	As Boolean
	Public 	strActoinTextSelected	As String
	
	Type Setting(FirstLang 	As String, _
				 SecondLang As String, _
				 Creativity As Int, _
				 AutoSend 	As Boolean, _
				 Memory 	As Boolean, _
				 IsDevMode 	As Boolean)		'If its in Development Mode, just for MySelf
End Sub

Sub Globals
	Private ChatN1 				As ChatN
	Private ime 				As IME2
End Sub

Sub Activity_Create(FirstTime As Boolean)
	
	General.LoadSetting
	
	
'	chat1.Initialize(Activity)
	ChatN1.Initialize(Activity)
	Activity.Title = "Ask ChatGPT"
	
	Voicer.Initialize("vr")
	
	ime.Initialize("ime")
	ime.AddHeightChangedEvent
	
	ChatN1.txtQuestion.RequestFocus
	
'	ChatN1.panMain.RemoveAllViews
'	Activity.AddView(ChatN1.panMain, 0, ChatN1.pTopMenu.Height, Activity.Width, ChatN1.clvMessages.sv.Height)
	
End Sub

Sub IME_HeightChanged (NewHeight As Int, OldHeight As Int)
'	chat1.HeightChanged(NewHeight)
End Sub

Sub Activity_Resume
	
	ChatN1.AdjustSize_Clv(0)
	ChatN1.IME_HeightChanged(100%y, 0)
	
	If IsRelevantIntent(Activity.GetStartingIntent) Then
		
		Dim intent As JavaObject = Activity.GetStartingIntent
		
		Dim cType As String = intent.RunMethod("getType", Null)
		If Not (cType.Contains("text")) Then Return
		
		Dim intnew 		As Intent = Activity.GetStartingIntent
		Dim sharedText 	As String = intnew.GetExtra("android.intent.extra.TEXT") 'Get the shared text
'		LogColor("Here: " & sharedText, Colors.Red)
		
		ChatN1.txtQuestion.Text = sharedText
		Sleep(0)
		If (General.Pref.AutoSend) Then _
			ChatN1.imgSend_Click
		
		#Region Shared a Image
'		'### It's Image
'		Dim uri As String = intent.RunMethod("getParcelableExtra", Array("android.intent.extra.STREAM"))
'		Dim flag As Boolean
'		Try
'			Log("Loading bitmap from: " & uri)
'			Dim bmp As Bitmap = LoadBitmapResize("ContentDir", uri, 100%x, 100%y,flag)
'			Activity.SetBackgroundImage(bmp)
'		Catch
'			Log(LastException)
'		End Try
		#End Region
		
	Else If (strActoinTextSelected <> "") Then
		
'		LogColor("Sec: " & strActoinTextSelected, Colors.Magenta)
		ChatN1.txtQuestion.Text = strActoinTextSelected
		strActoinTextSelected = ""
		Sleep(0)
		If (General.Pref.AutoSend) Then _
			ChatN1.imgSend_Click
		
	End If
End Sub

'Share Text
Private Sub IsRelevantIntent(in As Intent) As Boolean
	If in.IsInitialized And in <> OldIntent And in.Action = in.ACTION_SEND Then
		OldIntent = in
		Return True
	End If
	Return False
End Sub

Private Sub ShareText(text As String)
	Dim in As Intent
		in.Initialize(in.ACTION_SEND, "")
		in.PutExtra("android.intent.extra.TEXT", text)
		in.SetType("text/plain")
		in.WrapAsIntentChooser("Share Via")
	StartActivity(in)
End Sub

Private Sub SendToInstagram(text As String)
'	Dim u As Uri 'ContentResolver library
'	u.Parse("file://" & File.Combine(a, "tmpfile.jpg"))
'	Dim inten As Intent
'	Dim tmpt As String = "your text"
'	inten.Initialize(inten.ACTION_SEND,"")
'	inten.SetType("image/*")
'	inten.PutExtra("android.intent.extra.STREAM",u)
'	inten.PutExtra("android.intent.extra.TEXT",tmpt)
'	inten.SetComponent("com.instagram.android/com.instagram.share.handleractivity.ShareHandlerActivity")
'	StartActivity(inten)
End Sub

Private Sub SendToTwitter(text As String)
'	Dim u As Uri 'ContentResolver library
'	u.Parse("file://" & File.Combine(a, "tmpfile.jpg"))
'	Dim inten As Intent
'	Dim tmpt As String = "your text"
'	inten.Initialize(inten.ACTION_SEND,"")
'	inten.SetType("image/*")
'	inten.PutExtra("android.intent.extra.STREAM",u)
'	inten.PutExtra("android.intent.extra.TEXT",tmpt)
'	inten.SetComponent("com.twitter.android/com.twitter.composer.ComposerActivity")
'	StartActivity(inten)


'	Dim IntentInstagram As String
'	Dim IntentTwitter As String
'	Dim pm As PackageManager
'    
'	For Each cn As String In pm.QueryIntentActivities(inten)
'		'Instagram
'		If cn.SubString2(0,19) = "com.twitter.android" Then
'			IntentTwitter = cn
'			Exit
'		End If
'
'		'OR
'
'		'Twitter
'		If cn.SubString2(0,21) = "com.instagram.android" Then
'			IntentInstagram = cn
'			Exit
'		End If
'	Next
End Sub

Sub Activity_Pause (UserClosed As Boolean)
	General.SaveSetting
End Sub

#if Java
public boolean _onCreateOptionsMenu(android.view.Menu menu) {
	 processBA.raiseEvent(null, "create_menu", menu);
	 return true;
	
}
#End If
#End Region

'Program code should go into B4XMainPage and other pages.
